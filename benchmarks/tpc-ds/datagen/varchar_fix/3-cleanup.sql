-- USE iceberg.tpcds_sf1000_parquet_iceberg;
CALL iceberg.system.remove_orphan_files(table => 'iceberg.tpcds_sf1000_parquet_iceberg.call_center', dry_run => false);
CALL iceberg.system.remove_orphan_files(table => 'iceberg.tpcds_sf1000_parquet_iceberg.customer', dry_run => false);
CALL iceberg.system.remove_orphan_files(table => 'iceberg.tpcds_sf1000_parquet_iceberg.customer_address', dry_run => false);
CALL iceberg.system.remove_orphan_files(table => 'iceberg.tpcds_sf1000_parquet_iceberg.customer_demographics', dry_run => false);
CALL iceberg.system.remove_orphan_files(table => 'iceberg.tpcds_sf1000_parquet_iceberg.date_dim', dry_run => false);
CALL iceberg.system.remove_orphan_files(table => 'iceberg.tpcds_sf1000_parquet_iceberg.household_demographics', dry_run => false);
CALL iceberg.system.remove_orphan_files(table => 'iceberg.tpcds_sf1000_parquet_iceberg.item', dry_run => false);
CALL iceberg.system.remove_orphan_files(table => 'iceberg.tpcds_sf1000_parquet_iceberg.promotion', dry_run => false);
CALL iceberg.system.remove_orphan_files(table => 'iceberg.tpcds_sf1000_parquet_iceberg.reason', dry_run => false);
CALL iceberg.system.remove_orphan_files(table => 'iceberg.tpcds_sf1000_parquet_iceberg.ship_mode', dry_run => false);
CALL iceberg.system.remove_orphan_files(table => 'iceberg.tpcds_sf1000_parquet_iceberg.store', dry_run => false);
CALL iceberg.system.remove_orphan_files(table => 'iceberg.tpcds_sf1000_parquet_iceberg.time_dim', dry_run => false);
CALL iceberg.system.remove_orphan_files(table => 'iceberg.tpcds_sf1000_parquet_iceberg.warehouse', dry_run => false);
CALL iceberg.system.remove_orphan_files(table => 'iceberg.tpcds_sf1000_parquet_iceberg.web_page', dry_run => false);
CALL iceberg.system.remove_orphan_files(table => 'iceberg.tpcds_sf1000_parquet_iceberg.web_site', dry_run => false);

CALL iceberg.system.expire_snapshots(table => 'iceberg.tpcds_sf1000_parquet_iceberg.call_center', older_than => TIMESTAMP '2024-03-16', retain_last => 1);
CALL iceberg.system.expire_snapshots(table => 'iceberg.tpcds_sf1000_parquet_iceberg.customer', older_than => TIMESTAMP '2024-03-16', retain_last => 1);
CALL iceberg.system.expire_snapshots(table => 'iceberg.tpcds_sf1000_parquet_iceberg.customer_address', older_than => TIMESTAMP '2024-03-16', retain_last => 1);
CALL iceberg.system.expire_snapshots(table => 'iceberg.tpcds_sf1000_parquet_iceberg.customer_demographics', older_than => TIMESTAMP '2024-03-16', retain_last => 1);
CALL iceberg.system.expire_snapshots(table => 'iceberg.tpcds_sf1000_parquet_iceberg.date_dim', older_than => TIMESTAMP '2024-03-16', retain_last => 1);
CALL iceberg.system.expire_snapshots(table => 'iceberg.tpcds_sf1000_parquet_iceberg.household_demographics', older_than => TIMESTAMP '2024-03-16', retain_last => 1);
CALL iceberg.system.expire_snapshots(table => 'iceberg.tpcds_sf1000_parquet_iceberg.item', older_than => TIMESTAMP '2024-03-16', retain_last => 1);
CALL iceberg.system.expire_snapshots(table => 'iceberg.tpcds_sf1000_parquet_iceberg.promotion', older_than => TIMESTAMP '2024-03-16', retain_last => 1);
CALL iceberg.system.expire_snapshots(table => 'iceberg.tpcds_sf1000_parquet_iceberg.reason', older_than => TIMESTAMP '2024-03-16', retain_last => 1);
CALL iceberg.system.expire_snapshots(table => 'iceberg.tpcds_sf1000_parquet_iceberg.ship_mode', older_than => TIMESTAMP '2024-03-16', retain_last => 1);
CALL iceberg.system.expire_snapshots(table => 'iceberg.tpcds_sf1000_parquet_iceberg.store', older_than => TIMESTAMP '2024-03-16', retain_last => 1);
CALL iceberg.system.expire_snapshots(table => 'iceberg.tpcds_sf1000_parquet_iceberg.time_dim', older_than => TIMESTAMP '2024-03-16', retain_last => 1);
CALL iceberg.system.expire_snapshots(table => 'iceberg.tpcds_sf1000_parquet_iceberg.warehouse', older_than => TIMESTAMP '2024-03-16', retain_last => 1);
CALL iceberg.system.expire_snapshots(table => 'iceberg.tpcds_sf1000_parquet_iceberg.web_page', older_than => TIMESTAMP '2024-03-16', retain_last => 1);
CALL iceberg.system.expire_snapshots(table => 'iceberg.tpcds_sf1000_parquet_iceberg.web_site', older_than => TIMESTAMP '2024-03-16', retain_last => 1);

CALL iceberg.system.rewrite_manifests(table => 'iceberg.tpcds_sf1000_parquet_iceberg.call_center');
CALL iceberg.system.rewrite_manifests(table => 'iceberg.tpcds_sf1000_parquet_iceberg.customer');
CALL iceberg.system.rewrite_manifests(table => 'iceberg.tpcds_sf1000_parquet_iceberg.customer_address');
CALL iceberg.system.rewrite_manifests(table => 'iceberg.tpcds_sf1000_parquet_iceberg.customer_demographics');
CALL iceberg.system.rewrite_manifests(table => 'iceberg.tpcds_sf1000_parquet_iceberg.date_dim');
CALL iceberg.system.rewrite_manifests(table => 'iceberg.tpcds_sf1000_parquet_iceberg.household_demographics');
CALL iceberg.system.rewrite_manifests(table => 'iceberg.tpcds_sf1000_parquet_iceberg.item');
CALL iceberg.system.rewrite_manifests(table => 'iceberg.tpcds_sf1000_parquet_iceberg.promotion');
CALL iceberg.system.rewrite_manifests(table => 'iceberg.tpcds_sf1000_parquet_iceberg.reason');
CALL iceberg.system.rewrite_manifests(table => 'iceberg.tpcds_sf1000_parquet_iceberg.ship_mode');
CALL iceberg.system.rewrite_manifests(table => 'iceberg.tpcds_sf1000_parquet_iceberg.store');
CALL iceberg.system.rewrite_manifests(table => 'iceberg.tpcds_sf1000_parquet_iceberg.time_dim');
CALL iceberg.system.rewrite_manifests(table => 'iceberg.tpcds_sf1000_parquet_iceberg.warehouse');
CALL iceberg.system.rewrite_manifests(table => 'iceberg.tpcds_sf1000_parquet_iceberg.web_page');
CALL iceberg.system.rewrite_manifests(table => 'iceberg.tpcds_sf1000_parquet_iceberg.web_site');

-- USE iceberg.tpcds_sf1000_parquet_varchar_iceberg_part;
CALL iceberg.system.remove_orphan_files(table => 'iceberg.tpcds_sf1000_parquet_varchar_iceberg_part.call_center', dry_run => false);
CALL iceberg.system.remove_orphan_files(table => 'iceberg.tpcds_sf1000_parquet_varchar_iceberg_part.customer', dry_run => false);
CALL iceberg.system.remove_orphan_files(table => 'iceberg.tpcds_sf1000_parquet_varchar_iceberg_part.customer_address', dry_run => false);
CALL iceberg.system.remove_orphan_files(table => 'iceberg.tpcds_sf1000_parquet_varchar_iceberg_part.customer_demographics', dry_run => false);
CALL iceberg.system.remove_orphan_files(table => 'iceberg.tpcds_sf1000_parquet_varchar_iceberg_part.date_dim', dry_run => false);
CALL iceberg.system.remove_orphan_files(table => 'iceberg.tpcds_sf1000_parquet_varchar_iceberg_part.household_demographics', dry_run => false);
CALL iceberg.system.remove_orphan_files(table => 'iceberg.tpcds_sf1000_parquet_varchar_iceberg_part.item', dry_run => false);
CALL iceberg.system.remove_orphan_files(table => 'iceberg.tpcds_sf1000_parquet_varchar_iceberg_part.promotion', dry_run => false);
CALL iceberg.system.remove_orphan_files(table => 'iceberg.tpcds_sf1000_parquet_varchar_iceberg_part.reason', dry_run => false);
CALL iceberg.system.remove_orphan_files(table => 'iceberg.tpcds_sf1000_parquet_varchar_iceberg_part.ship_mode', dry_run => false);
CALL iceberg.system.remove_orphan_files(table => 'iceberg.tpcds_sf1000_parquet_varchar_iceberg_part.store', dry_run => false);
CALL iceberg.system.remove_orphan_files(table => 'iceberg.tpcds_sf1000_parquet_varchar_iceberg_part.time_dim', dry_run => false);
CALL iceberg.system.remove_orphan_files(table => 'iceberg.tpcds_sf1000_parquet_varchar_iceberg_part.warehouse', dry_run => false);
CALL iceberg.system.remove_orphan_files(table => 'iceberg.tpcds_sf1000_parquet_varchar_iceberg_part.web_page', dry_run => false);
CALL iceberg.system.remove_orphan_files(table => 'iceberg.tpcds_sf1000_parquet_varchar_iceberg_part.web_site', dry_run => false);

CALL iceberg.system.expire_snapshots(table => 'iceberg.tpcds_sf1000_parquet_varchar_iceberg_part.call_center', older_than => TIMESTAMP '2024-03-16', retain_last => 1);
CALL iceberg.system.expire_snapshots(table => 'iceberg.tpcds_sf1000_parquet_varchar_iceberg_part.customer', older_than => TIMESTAMP '2024-03-16', retain_last => 1);
CALL iceberg.system.expire_snapshots(table => 'iceberg.tpcds_sf1000_parquet_varchar_iceberg_part.customer_address', older_than => TIMESTAMP '2024-03-16', retain_last => 1);
CALL iceberg.system.expire_snapshots(table => 'iceberg.tpcds_sf1000_parquet_varchar_iceberg_part.customer_demographics', older_than => TIMESTAMP '2024-03-16', retain_last => 1);
CALL iceberg.system.expire_snapshots(table => 'iceberg.tpcds_sf1000_parquet_varchar_iceberg_part.date_dim', older_than => TIMESTAMP '2024-03-16', retain_last => 1);
CALL iceberg.system.expire_snapshots(table => 'iceberg.tpcds_sf1000_parquet_varchar_iceberg_part.household_demographics', older_than => TIMESTAMP '2024-03-16', retain_last => 1);
CALL iceberg.system.expire_snapshots(table => 'iceberg.tpcds_sf1000_parquet_varchar_iceberg_part.item', older_than => TIMESTAMP '2024-03-16', retain_last => 1);
CALL iceberg.system.expire_snapshots(table => 'iceberg.tpcds_sf1000_parquet_varchar_iceberg_part.promotion', older_than => TIMESTAMP '2024-03-16', retain_last => 1);
CALL iceberg.system.expire_snapshots(table => 'iceberg.tpcds_sf1000_parquet_varchar_iceberg_part.reason', older_than => TIMESTAMP '2024-03-16', retain_last => 1);
CALL iceberg.system.expire_snapshots(table => 'iceberg.tpcds_sf1000_parquet_varchar_iceberg_part.ship_mode', older_than => TIMESTAMP '2024-03-16', retain_last => 1);
CALL iceberg.system.expire_snapshots(table => 'iceberg.tpcds_sf1000_parquet_varchar_iceberg_part.store', older_than => TIMESTAMP '2024-03-16', retain_last => 1);
CALL iceberg.system.expire_snapshots(table => 'iceberg.tpcds_sf1000_parquet_varchar_iceberg_part.time_dim', older_than => TIMESTAMP '2024-03-16', retain_last => 1);
CALL iceberg.system.expire_snapshots(table => 'iceberg.tpcds_sf1000_parquet_varchar_iceberg_part.warehouse', older_than => TIMESTAMP '2024-03-16', retain_last => 1);
CALL iceberg.system.expire_snapshots(table => 'iceberg.tpcds_sf1000_parquet_varchar_iceberg_part.web_page', older_than => TIMESTAMP '2024-03-16', retain_last => 1);
CALL iceberg.system.expire_snapshots(table => 'iceberg.tpcds_sf1000_parquet_varchar_iceberg_part.web_site', older_than => TIMESTAMP '2024-03-16', retain_last => 1);

CALL iceberg.system.rewrite_manifests(table => 'iceberg.tpcds_sf1000_parquet_varchar_iceberg_part.call_center');
CALL iceberg.system.rewrite_manifests(table => 'iceberg.tpcds_sf1000_parquet_varchar_iceberg_part.customer');
CALL iceberg.system.rewrite_manifests(table => 'iceberg.tpcds_sf1000_parquet_varchar_iceberg_part.customer_address');
CALL iceberg.system.rewrite_manifests(table => 'iceberg.tpcds_sf1000_parquet_varchar_iceberg_part.customer_demographics');
CALL iceberg.system.rewrite_manifests(table => 'iceberg.tpcds_sf1000_parquet_varchar_iceberg_part.date_dim');
CALL iceberg.system.rewrite_manifests(table => 'iceberg.tpcds_sf1000_parquet_varchar_iceberg_part.household_demographics');
CALL iceberg.system.rewrite_manifests(table => 'iceberg.tpcds_sf1000_parquet_varchar_iceberg_part.item');
CALL iceberg.system.rewrite_manifests(table => 'iceberg.tpcds_sf1000_parquet_varchar_iceberg_part.promotion');
CALL iceberg.system.rewrite_manifests(table => 'iceberg.tpcds_sf1000_parquet_varchar_iceberg_part.reason');
CALL iceberg.system.rewrite_manifests(table => 'iceberg.tpcds_sf1000_parquet_varchar_iceberg_part.ship_mode');
CALL iceberg.system.rewrite_manifests(table => 'iceberg.tpcds_sf1000_parquet_varchar_iceberg_part.store');
CALL iceberg.system.rewrite_manifests(table => 'iceberg.tpcds_sf1000_parquet_varchar_iceberg_part.time_dim');
CALL iceberg.system.rewrite_manifests(table => 'iceberg.tpcds_sf1000_parquet_varchar_iceberg_part.warehouse');
CALL iceberg.system.rewrite_manifests(table => 'iceberg.tpcds_sf1000_parquet_varchar_iceberg_part.web_page');
CALL iceberg.system.rewrite_manifests(table => 'iceberg.tpcds_sf1000_parquet_varchar_iceberg_part.web_site');

-- USE iceberg.tpcds_sf10000_parquet_iceberg;
CALL iceberg.system.remove_orphan_files(table => 'iceberg.tpcds_sf10000_parquet_iceberg.call_center', dry_run => false);
CALL iceberg.system.remove_orphan_files(table => 'iceberg.tpcds_sf10000_parquet_iceberg.customer', dry_run => false);
CALL iceberg.system.remove_orphan_files(table => 'iceberg.tpcds_sf10000_parquet_iceberg.customer_address', dry_run => false);
CALL iceberg.system.remove_orphan_files(table => 'iceberg.tpcds_sf10000_parquet_iceberg.customer_demographics', dry_run => false);
CALL iceberg.system.remove_orphan_files(table => 'iceberg.tpcds_sf10000_parquet_iceberg.date_dim', dry_run => false);
CALL iceberg.system.remove_orphan_files(table => 'iceberg.tpcds_sf10000_parquet_iceberg.household_demographics', dry_run => false);
CALL iceberg.system.remove_orphan_files(table => 'iceberg.tpcds_sf10000_parquet_iceberg.item', dry_run => false);
CALL iceberg.system.remove_orphan_files(table => 'iceberg.tpcds_sf10000_parquet_iceberg.promotion', dry_run => false);
CALL iceberg.system.remove_orphan_files(table => 'iceberg.tpcds_sf10000_parquet_iceberg.reason', dry_run => false);
CALL iceberg.system.remove_orphan_files(table => 'iceberg.tpcds_sf10000_parquet_iceberg.ship_mode', dry_run => false);
CALL iceberg.system.remove_orphan_files(table => 'iceberg.tpcds_sf10000_parquet_iceberg.store', dry_run => false);
CALL iceberg.system.remove_orphan_files(table => 'iceberg.tpcds_sf10000_parquet_iceberg.time_dim', dry_run => false);
CALL iceberg.system.remove_orphan_files(table => 'iceberg.tpcds_sf10000_parquet_iceberg.warehouse', dry_run => false);
CALL iceberg.system.remove_orphan_files(table => 'iceberg.tpcds_sf10000_parquet_iceberg.web_page', dry_run => false);
CALL iceberg.system.remove_orphan_files(table => 'iceberg.tpcds_sf10000_parquet_iceberg.web_site', dry_run => false);

CALL iceberg.system.expire_snapshots(table => 'iceberg.tpcds_sf10000_parquet_iceberg.call_center', older_than => TIMESTAMP '2024-03-16', retain_last => 1);
CALL iceberg.system.expire_snapshots(table => 'iceberg.tpcds_sf10000_parquet_iceberg.customer', older_than => TIMESTAMP '2024-03-16', retain_last => 1);
CALL iceberg.system.expire_snapshots(table => 'iceberg.tpcds_sf10000_parquet_iceberg.customer_address', older_than => TIMESTAMP '2024-03-16', retain_last => 1);
CALL iceberg.system.expire_snapshots(table => 'iceberg.tpcds_sf10000_parquet_iceberg.customer_demographics', older_than => TIMESTAMP '2024-03-16', retain_last => 1);
CALL iceberg.system.expire_snapshots(table => 'iceberg.tpcds_sf10000_parquet_iceberg.date_dim', older_than => TIMESTAMP '2024-03-16', retain_last => 1);
CALL iceberg.system.expire_snapshots(table => 'iceberg.tpcds_sf10000_parquet_iceberg.household_demographics', older_than => TIMESTAMP '2024-03-16', retain_last => 1);
CALL iceberg.system.expire_snapshots(table => 'iceberg.tpcds_sf10000_parquet_iceberg.item', older_than => TIMESTAMP '2024-03-16', retain_last => 1);
CALL iceberg.system.expire_snapshots(table => 'iceberg.tpcds_sf10000_parquet_iceberg.promotion', older_than => TIMESTAMP '2024-03-16', retain_last => 1);
CALL iceberg.system.expire_snapshots(table => 'iceberg.tpcds_sf10000_parquet_iceberg.reason', older_than => TIMESTAMP '2024-03-16', retain_last => 1);
CALL iceberg.system.expire_snapshots(table => 'iceberg.tpcds_sf10000_parquet_iceberg.ship_mode', older_than => TIMESTAMP '2024-03-16', retain_last => 1);
CALL iceberg.system.expire_snapshots(table => 'iceberg.tpcds_sf10000_parquet_iceberg.store', older_than => TIMESTAMP '2024-03-16', retain_last => 1);
CALL iceberg.system.expire_snapshots(table => 'iceberg.tpcds_sf10000_parquet_iceberg.time_dim', older_than => TIMESTAMP '2024-03-16', retain_last => 1);
CALL iceberg.system.expire_snapshots(table => 'iceberg.tpcds_sf10000_parquet_iceberg.warehouse', older_than => TIMESTAMP '2024-03-16', retain_last => 1);
CALL iceberg.system.expire_snapshots(table => 'iceberg.tpcds_sf10000_parquet_iceberg.web_page', older_than => TIMESTAMP '2024-03-16', retain_last => 1);
CALL iceberg.system.expire_snapshots(table => 'iceberg.tpcds_sf10000_parquet_iceberg.web_site', older_than => TIMESTAMP '2024-03-16', retain_last => 1);

CALL iceberg.system.rewrite_manifests(table => 'iceberg.tpcds_sf10000_parquet_iceberg.call_center');
CALL iceberg.system.rewrite_manifests(table => 'iceberg.tpcds_sf10000_parquet_iceberg.customer');
CALL iceberg.system.rewrite_manifests(table => 'iceberg.tpcds_sf10000_parquet_iceberg.customer_address');
CALL iceberg.system.rewrite_manifests(table => 'iceberg.tpcds_sf10000_parquet_iceberg.customer_demographics');
CALL iceberg.system.rewrite_manifests(table => 'iceberg.tpcds_sf10000_parquet_iceberg.date_dim');
CALL iceberg.system.rewrite_manifests(table => 'iceberg.tpcds_sf10000_parquet_iceberg.household_demographics');
CALL iceberg.system.rewrite_manifests(table => 'iceberg.tpcds_sf10000_parquet_iceberg.item');
CALL iceberg.system.rewrite_manifests(table => 'iceberg.tpcds_sf10000_parquet_iceberg.promotion');
CALL iceberg.system.rewrite_manifests(table => 'iceberg.tpcds_sf10000_parquet_iceberg.reason');
CALL iceberg.system.rewrite_manifests(table => 'iceberg.tpcds_sf10000_parquet_iceberg.ship_mode');
CALL iceberg.system.rewrite_manifests(table => 'iceberg.tpcds_sf10000_parquet_iceberg.store');
CALL iceberg.system.rewrite_manifests(table => 'iceberg.tpcds_sf10000_parquet_iceberg.time_dim');
CALL iceberg.system.rewrite_manifests(table => 'iceberg.tpcds_sf10000_parquet_iceberg.warehouse');
CALL iceberg.system.rewrite_manifests(table => 'iceberg.tpcds_sf10000_parquet_iceberg.web_page');
CALL iceberg.system.rewrite_manifests(table => 'iceberg.tpcds_sf10000_parquet_iceberg.web_site');

-- USE iceberg.tpcds_sf10000_parquet_varchar_iceberg_part;
CALL iceberg.system.remove_orphan_files(table => 'iceberg.tpcds_sf10000_parquet_varchar_iceberg_part.call_center', dry_run => false);
CALL iceberg.system.remove_orphan_files(table => 'iceberg.tpcds_sf10000_parquet_varchar_iceberg_part.customer', dry_run => false);
CALL iceberg.system.remove_orphan_files(table => 'iceberg.tpcds_sf10000_parquet_varchar_iceberg_part.customer_address', dry_run => false);
CALL iceberg.system.remove_orphan_files(table => 'iceberg.tpcds_sf10000_parquet_varchar_iceberg_part.customer_demographics', dry_run => false);
CALL iceberg.system.remove_orphan_files(table => 'iceberg.tpcds_sf10000_parquet_varchar_iceberg_part.date_dim', dry_run => false);
CALL iceberg.system.remove_orphan_files(table => 'iceberg.tpcds_sf10000_parquet_varchar_iceberg_part.household_demographics', dry_run => false);
CALL iceberg.system.remove_orphan_files(table => 'iceberg.tpcds_sf10000_parquet_varchar_iceberg_part.item', dry_run => false);
CALL iceberg.system.remove_orphan_files(table => 'iceberg.tpcds_sf10000_parquet_varchar_iceberg_part.promotion', dry_run => false);
CALL iceberg.system.remove_orphan_files(table => 'iceberg.tpcds_sf10000_parquet_varchar_iceberg_part.reason', dry_run => false);
CALL iceberg.system.remove_orphan_files(table => 'iceberg.tpcds_sf10000_parquet_varchar_iceberg_part.ship_mode', dry_run => false);
CALL iceberg.system.remove_orphan_files(table => 'iceberg.tpcds_sf10000_parquet_varchar_iceberg_part.store', dry_run => false);
CALL iceberg.system.remove_orphan_files(table => 'iceberg.tpcds_sf10000_parquet_varchar_iceberg_part.time_dim', dry_run => false);
CALL iceberg.system.remove_orphan_files(table => 'iceberg.tpcds_sf10000_parquet_varchar_iceberg_part.warehouse', dry_run => false);
CALL iceberg.system.remove_orphan_files(table => 'iceberg.tpcds_sf10000_parquet_varchar_iceberg_part.web_page', dry_run => false);
CALL iceberg.system.remove_orphan_files(table => 'iceberg.tpcds_sf10000_parquet_varchar_iceberg_part.web_site', dry_run => false);

CALL iceberg.system.expire_snapshots(table => 'iceberg.tpcds_sf10000_parquet_varchar_iceberg_part.call_center', older_than => TIMESTAMP '2024-03-16', retain_last => 1);
CALL iceberg.system.expire_snapshots(table => 'iceberg.tpcds_sf10000_parquet_varchar_iceberg_part.customer', older_than => TIMESTAMP '2024-03-16', retain_last => 1);
CALL iceberg.system.expire_snapshots(table => 'iceberg.tpcds_sf10000_parquet_varchar_iceberg_part.customer_address', older_than => TIMESTAMP '2024-03-16', retain_last => 1);
CALL iceberg.system.expire_snapshots(table => 'iceberg.tpcds_sf10000_parquet_varchar_iceberg_part.customer_demographics', older_than => TIMESTAMP '2024-03-16', retain_last => 1);
CALL iceberg.system.expire_snapshots(table => 'iceberg.tpcds_sf10000_parquet_varchar_iceberg_part.date_dim', older_than => TIMESTAMP '2024-03-16', retain_last => 1);
CALL iceberg.system.expire_snapshots(table => 'iceberg.tpcds_sf10000_parquet_varchar_iceberg_part.household_demographics', older_than => TIMESTAMP '2024-03-16', retain_last => 1);
CALL iceberg.system.expire_snapshots(table => 'iceberg.tpcds_sf10000_parquet_varchar_iceberg_part.item', older_than => TIMESTAMP '2024-03-16', retain_last => 1);
CALL iceberg.system.expire_snapshots(table => 'iceberg.tpcds_sf10000_parquet_varchar_iceberg_part.promotion', older_than => TIMESTAMP '2024-03-16', retain_last => 1);
CALL iceberg.system.expire_snapshots(table => 'iceberg.tpcds_sf10000_parquet_varchar_iceberg_part.reason', older_than => TIMESTAMP '2024-03-16', retain_last => 1);
CALL iceberg.system.expire_snapshots(table => 'iceberg.tpcds_sf10000_parquet_varchar_iceberg_part.ship_mode', older_than => TIMESTAMP '2024-03-16', retain_last => 1);
CALL iceberg.system.expire_snapshots(table => 'iceberg.tpcds_sf10000_parquet_varchar_iceberg_part.store', older_than => TIMESTAMP '2024-03-16', retain_last => 1);
CALL iceberg.system.expire_snapshots(table => 'iceberg.tpcds_sf10000_parquet_varchar_iceberg_part.time_dim', older_than => TIMESTAMP '2024-03-16', retain_last => 1);
CALL iceberg.system.expire_snapshots(table => 'iceberg.tpcds_sf10000_parquet_varchar_iceberg_part.warehouse', older_than => TIMESTAMP '2024-03-16', retain_last => 1);
CALL iceberg.system.expire_snapshots(table => 'iceberg.tpcds_sf10000_parquet_varchar_iceberg_part.web_page', older_than => TIMESTAMP '2024-03-16', retain_last => 1);
CALL iceberg.system.expire_snapshots(table => 'iceberg.tpcds_sf10000_parquet_varchar_iceberg_part.web_site', older_than => TIMESTAMP '2024-03-16', retain_last => 1);

CALL iceberg.system.rewrite_manifests(table => 'iceberg.tpcds_sf10000_parquet_varchar_iceberg_part.call_center');
CALL iceberg.system.rewrite_manifests(table => 'iceberg.tpcds_sf10000_parquet_varchar_iceberg_part.customer');
CALL iceberg.system.rewrite_manifests(table => 'iceberg.tpcds_sf10000_parquet_varchar_iceberg_part.customer_address');
CALL iceberg.system.rewrite_manifests(table => 'iceberg.tpcds_sf10000_parquet_varchar_iceberg_part.customer_demographics');
CALL iceberg.system.rewrite_manifests(table => 'iceberg.tpcds_sf10000_parquet_varchar_iceberg_part.date_dim');
CALL iceberg.system.rewrite_manifests(table => 'iceberg.tpcds_sf10000_parquet_varchar_iceberg_part.household_demographics');
CALL iceberg.system.rewrite_manifests(table => 'iceberg.tpcds_sf10000_parquet_varchar_iceberg_part.item');
CALL iceberg.system.rewrite_manifests(table => 'iceberg.tpcds_sf10000_parquet_varchar_iceberg_part.promotion');
CALL iceberg.system.rewrite_manifests(table => 'iceberg.tpcds_sf10000_parquet_varchar_iceberg_part.reason');
CALL iceberg.system.rewrite_manifests(table => 'iceberg.tpcds_sf10000_parquet_varchar_iceberg_part.ship_mode');
CALL iceberg.system.rewrite_manifests(table => 'iceberg.tpcds_sf10000_parquet_varchar_iceberg_part.store');
CALL iceberg.system.rewrite_manifests(table => 'iceberg.tpcds_sf10000_parquet_varchar_iceberg_part.time_dim');
CALL iceberg.system.rewrite_manifests(table => 'iceberg.tpcds_sf10000_parquet_varchar_iceberg_part.warehouse');
CALL iceberg.system.rewrite_manifests(table => 'iceberg.tpcds_sf10000_parquet_varchar_iceberg_part.web_page');
CALL iceberg.system.rewrite_manifests(table => 'iceberg.tpcds_sf10000_parquet_varchar_iceberg_part.web_site');
